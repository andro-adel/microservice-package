<p align="center"><a href="https://dd.sa" target="_blank"><svg version="1.0" xmlns="http://www.w3.org/2000/svg"
width="300.000000pt" height="124.000000pt" viewBox="0 0 300.000000 124.000000"
preserveAspectRatio="xMidYMid meet">
<g transform="translate(0.000000,124.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M699 1075 c-53 -19 -115 -62 -144 -101 l-26 -34 62 0 c47 0 75 7 115
26 46 22 64 26 123 22 93 -5 154 -42 193 -117 67 -128 14 -283 -117 -342 -33
-15 -66 -19 -185 -19 l-145 0 0 140 0 140 33 0 c39 0 105 -31 145 -69 35 -32
67 -92 67 -124 0 -34 7 -37 56 -20 54 18 56 35 14 121 -36 72 -92 125 -167
159 -61 28 -159 40 -211 27 l-32 -9 -3 -233 -2 -232 140 0 c133 0 182 8 156
25 -7 3 -65 7 -131 8 -65 1 -121 5 -125 8 -11 12 -6 381 6 395 17 20 96 17
166 -7 43 -14 76 -34 108 -66 49 -47 91 -124 81 -149 -10 -25 -22 -15 -43 34
-50 115 -215 201 -269 141 -16 -18 -18 -36 -17 -152 3 -176 -5 -170 199 -166
143 4 152 5 190 30 93 62 145 146 145 235 0 89 -21 141 -83 201 -79 76 -194
94 -298 47 -44 -19 -63 -23 -76 -16 -16 9 -12 14 31 41 27 17 62 33 79 36 78
12 110 12 156 0 138 -36 220 -140 228 -290 4 -70 1 -87 -21 -135 -32 -69 -82
-122 -146 -152 -28 -12 -53 -31 -56 -40 -6 -17 -58 -33 -87 -26 -8 2 -30 -12
-49 -31 -61 -61 -95 -71 -264 -71 l-150 0 5 163 c5 162 5 164 35 208 23 33 31
59 35 107 3 34 1 62 -3 62 -5 0 -35 -26 -66 -58 -91 -91 -101 -127 -101 -378
l0 -205 213 3 c191 3 216 5 258 24 59 28 123 85 155 140 19 33 39 49 79 68 63
28 134 96 167 158 20 37 23 58 23 143 0 81 -4 109 -22 147 -31 67 -96 133
-166 168 -53 26 -70 30 -141 29 -45 0 -97 -6 -117 -14z m-309 -324 c0 -9 -8
-26 -17 -37 -19 -20 -35 -50 -51 -99 -6 -16 -10 -88 -9 -160 2 -148 12 -175
62 -175 16 -1 71 -2 120 -4 139 -4 196 12 275 76 43 35 66 38 49 6 -17 -33
-57 -66 -109 -89 -39 -18 -69 -22 -220 -25 -96 -2 -183 -1 -192 2 -16 5 -18
22 -18 182 1 197 11 247 65 314 30 37 45 41 45 9z"/>
<path d="M2177 788 l6 -83 -164 5 -164 5 -3 32 c-4 37 -42 73 -77 73 -12 0
-34 -9 -49 -21 -60 -47 -14 -137 64 -124 31 5 33 4 18 -8 -21 -17 -24 -47 -5
-47 15 0 47 31 47 46 0 5 98 9 233 9 127 1 241 1 252 2 11 1 44 2 73 2 28 0
61 0 72 0 11 0 32 0 48 0 15 -1 36 -1 47 0 11 1 34 -1 52 -5 24 -5 36 -1 52
15 17 17 21 33 21 91 0 63 -2 70 -20 70 -18 0 -20 -7 -20 -70 0 -68 -1 -70
-25 -70 -21 0 -25 5 -25 30 0 36 -38 80 -69 80 -11 0 -32 -5 -46 -12 -24 -11
-30 -22 -37 -73 -3 -16 -12 -21 -46 -23 -41 -3 -42 -2 -42 28 0 20 -9 40 -25
56 -22 22 -33 25 -75 22 -49 -3 -50 -2 -50 25 0 22 -4 27 -24 27 -24 0 -24 -1
-19 -82z m-372 -43 c0 -27 -3 -30 -30 -30 -21 0 -31 5 -33 18 -6 33 6 49 35
45 24 -3 28 -8 28 -33z m520 0 c0 -29 -2 -30 -52 -35 l-53 -6 0 39 0 38 53 -3
c50 -3 52 -4 52 -33z m240 0 c0 -24 -5 -31 -24 -33 -32 -5 -54 23 -40 50 7 13
19 18 37 16 23 -2 27 -8 27 -33z"/>
<path d="M2720 760 l0 -90 26 0 c24 0 26 3 20 31 -3 17 -6 58 -6 90 0 52 -2
59 -20 59 -19 0 -20 -7 -20 -90z"/>
<path d="M1331 830 c-16 -9 -6 -30 15 -30 15 0 20 25 6 34 -4 2 -14 1 -21 -4z"/>
<path d="M1475 808 c-28 -16 -35 -28 -35 -63 0 -16 4 -35 8 -41 13 -20 54 -36
78 -30 26 7 34 -8 9 -18 -8 -3 -15 -12 -15 -21 0 -21 26 -19 50 5 31 31 28
123 -5 155 -26 27 -58 31 -90 13z m70 -63 c0 -24 -5 -31 -24 -33 -32 -5 -54
23 -40 50 7 13 19 18 37 16 23 -2 27 -8 27 -33z"/>
<path d="M1371 735 c2 -69 -7 -89 -37 -83 -15 2 -20 14 -22 51 -2 28 1 47 7
47 25 0 8 28 -19 32 l-30 5 0 -64 c0 -75 20 -103 73 -103 52 0 67 24 67 108 0
66 -2 72 -21 72 -18 0 -20 -5 -18 -65z"/>
<path d="M1623 776 c-4 -5 -1 -12 5 -14 18 -6 15 -87 -3 -102 -8 -7 -15 -19
-15 -26 0 -21 27 -17 50 6 17 17 20 31 18 82 -3 56 -5 62 -26 63 -13 1 -26 -3
-29 -9z"/>
<path d="M2480 521 c0 -46 -4 -70 -12 -73 -24 -9 -38 3 -38 32 0 43 -31 74
-73 74 -44 0 -77 -27 -77 -64 0 -30 -23 -56 -40 -45 -5 3 -10 15 -10 25 0 62
-45 90 -137 88 l-53 -1 0 -59 c0 -41 -4 -58 -13 -58 -21 0 -37 22 -37 50 0 33
-10 47 -41 58 -56 22 -109 -12 -109 -70 0 -30 -11 -41 -34 -32 -9 4 -16 18
-16 34 0 43 -31 74 -73 74 -47 0 -77 -27 -77 -69 0 -21 -6 -35 -16 -39 -23 -9
-34 2 -34 32 0 58 -53 92 -109 70 -33 -12 -41 -25 -41 -70 0 -47 34 -74 80
-64 31 6 43 -10 15 -20 -8 -4 -15 -13 -15 -21 0 -22 43 -12 55 14 8 19 51 34
93 32 6 0 28 0 47 0 19 0 42 0 50 0 8 0 31 0 50 0 19 0 41 0 48 1 6 0 27 -3
45 -6 20 -4 38 -2 48 6 11 10 18 10 26 2 14 -14 186 -16 207 -3 7 5 25 4 42
-3 22 -8 34 -8 48 1 15 9 26 9 49 1 22 -9 37 -9 55 -1 14 7 29 8 38 2 24 -15
58 -10 79 11 16 16 20 33 20 90 0 63 -2 70 -20 70 -18 0 -20 -7 -20 -69z
m-936 -17 c10 -27 7 -43 -13 -54 -11 -5 -26 -7 -35 -4 -21 8 -30 42 -16 59 16
20 56 19 64 -1z m204 -13 c5 -32 -23 -54 -49 -40 -19 10 -26 49 -12 63 4 4 19
6 33 4 18 -2 26 -10 28 -27z m202 14 c14 -17 5 -51 -16 -59 -22 -8 -54 11 -54
32 0 38 46 56 70 27z m228 3 c30 -30 -2 -68 -59 -68 -39 0 -39 0 -39 40 l0 40
43 0 c24 0 48 -5 55 -12z m210 -20 c2 -19 -3 -30 -18 -38 -27 -14 -50 2 -50
35 0 29 9 37 40 33 19 -2 26 -10 28 -30z"/>
<path d="M2540 500 l0 -90 26 0 c22 0 25 3 20 23 -3 12 -6 52 -6 90 0 60 -2
67 -20 67 -19 0 -20 -7 -20 -90z"/>
<path d="M1320 555 c0 -8 9 -15 20 -15 11 0 20 7 20 15 0 8 -9 15 -20 15 -11
0 -20 -7 -20 -15z"/>
<path d="M2690 553 c-52 -19 -68 -85 -29 -124 16 -16 29 -20 55 -16 34 6 48
-8 19 -19 -22 -9 -18 -34 4 -34 31 0 51 38 51 96 0 35 -6 58 -17 72 -19 21
-59 33 -83 25z m58 -65 c2 -19 -3 -30 -19 -39 -20 -10 -25 -9 -41 11 -24 30
-8 63 30 58 21 -2 28 -9 30 -30z"/>
<path d="M1371 475 c2 -69 -7 -89 -37 -83 -15 2 -20 14 -22 51 -2 28 1 47 7
47 6 0 11 7 11 15 0 10 -10 15 -30 15 -30 0 -30 0 -30 -58 0 -76 18 -102 70
-102 58 0 70 18 70 106 0 68 -2 74 -21 74 -18 0 -20 -5 -18 -65z"/>
<path d="M1260 265 c0 -53 17 -66 55 -41 43 28 22 86 -31 86 -22 0 -24 -4 -24
-45z m58 -2 c-2 -17 -10 -29 -20 -31 -14 -3 -18 3 -18 27 0 25 4 31 21 31 16
0 20 -5 17 -27z"/>
<path d="M2050 296 c0 -7 -3 -27 -6 -43 -5 -23 -2 -32 12 -37 9 -4 22 -2 27 3
5 5 17 7 26 3 13 -5 14 -3 3 10 -7 8 -10 24 -6 34 5 18 5 18 -10 0 -9 -11 -16
-23 -16 -28 0 -4 -7 -8 -16 -8 -9 0 -14 6 -11 13 2 6 9 11 15 10 13 -3 26 33
17 47 -9 15 -35 12 -35 -4z"/>
<path d="M2180 265 c0 -50 15 -64 49 -46 46 25 28 91 -26 91 -21 0 -23 -4 -23
-45z m55 -5 c0 -16 -6 -26 -17 -28 -14 -3 -18 3 -18 28 0 25 4 31 18 28 11 -2
17 -12 17 -28z"/>
<path d="M1362 278 c-29 -29 4 -76 42 -62 25 10 18 22 -9 16 -15 -2 -25 0 -25
7 0 6 11 11 25 11 28 0 34 24 9 34 -22 8 -28 8 -42 -6z"/>
<path d="M1445 253 c21 -50 22 -50 39 -8 19 44 19 45 7 45 -5 0 -12 -12 -16
-27 l-8 -28 -10 28 c-6 15 -15 27 -19 27 -5 0 -1 -17 7 -37z"/>
<path d="M1520 275 c-15 -18 -10 -45 12 -59 14 -8 22 -7 35 7 17 18 17 18 -8
12 -16 -4 -30 -2 -33 4 -5 7 4 11 23 11 33 0 39 8 19 28 -16 16 -33 15 -48 -3z"/>
<path d="M1640 275 c-26 -31 13 -82 44 -56 19 16 21 42 4 59 -16 16 -33 15
-48 -3z m48 -22 c5 -17 -26 -29 -40 -15 -6 6 -7 15 -3 22 9 14 37 9 43 -7z"/>
<path d="M1717 245 c-2 -22 0 -44 4 -50 6 -5 9 -2 9 8 0 10 5 14 14 11 15 -6
46 21 46 40 0 19 -23 35 -47 33 -17 -1 -22 -9 -26 -42z m53 5 c0 -13 -7 -20
-20 -20 -13 0 -20 7 -20 20 0 13 7 20 20 20 13 0 20 -7 20 -20z"/>
<path d="M1812 278 c-19 -19 -14 -46 9 -59 17 -9 24 -8 36 4 13 13 12 14 -11
10 -15 -3 -26 -1 -26 6 0 6 11 11 25 11 28 0 34 24 9 34 -22 8 -28 8 -42 -6z"/>
<path d="M1890 249 c0 -22 4 -38 9 -35 4 3 6 17 3 31 -2 15 0 25 7 25 6 0 11
5 11 10 0 6 -7 10 -15 10 -11 0 -15 -11 -15 -41z"/>
<path d="M1935 279 c-4 -5 1 -20 12 -31 16 -20 17 -21 1 -15 -10 4 -18 2 -18
-3 0 -16 21 -22 36 -9 13 10 12 14 -2 30 -10 11 -12 19 -6 19 7 0 12 5 12 10
0 13 -27 13 -35 -1z"/>
<path d="M2280 275 c-15 -18 -10 -45 12 -59 14 -8 22 -7 35 7 17 18 17 18 -9
12 -18 -5 -28 -3 -28 4 0 6 11 11 25 11 27 0 32 9 13 28 -16 16 -33 15 -48 -3z"/>
<path d="M2363 275 c-3 -9 3 -23 13 -31 18 -15 18 -15 1 -10 -12 4 -17 2 -15
-6 7 -19 28 -21 35 -2 4 11 0 22 -12 30 -17 13 -17 14 -1 14 9 0 14 5 11 10
-9 15 -25 12 -32 -5z"/>
<path d="M2462 278 c-27 -27 1 -73 37 -60 9 3 11 0 7 -7 -4 -7 -16 -9 -27 -6
-11 4 -19 2 -19 -4 0 -17 47 -13 54 5 3 9 6 30 6 48 0 26 -4 32 -23 34 -13 1
-29 -4 -35 -10z m44 -37 c-9 -14 -33 -14 -41 -1 -4 6 -1 18 6 26 11 13 14 13
27 0 8 -8 11 -19 8 -25z"/>
<path d="M2541 246 c1 -37 2 -38 8 -11 9 43 38 45 44 3 4 -28 4 -27 3 7 -1 36
-3 40 -28 41 -26 1 -28 -1 -27 -40z"/>
<path d="M2630 275 c-15 -18 -10 -45 12 -59 14 -8 22 -7 35 7 17 18 17 18 -8
12 -16 -4 -30 -2 -33 4 -5 7 4 11 23 11 33 0 39 8 19 28 -16 16 -33 15 -48 -3z"/>
<path d="M2754 275 c-4 -9 1 -22 12 -31 18 -14 18 -15 -6 -8 -23 6 -24 5 -8
-11 22 -23 38 -11 35 27 -3 35 -23 49 -33 23z"/>
<path d="M871 266 c-22 -26 10 -63 43 -50 35 13 24 64 -14 64 -10 0 -23 -6
-29 -14z"/>
</g>
</svg></a></p>

<p align="center">
<a href="https://github.com/laravel/framework/actions"><img src="https://github.com/laravel/framework/workflows/tests/badge.svg" alt="Build Status"></a>
<a href="https://packagist.org/packages/laravel/framework"><img src="https://img.shields.io/packagist/dt/laravel/framework" alt="Total Downloads"></a>
<a href="https://packagist.org/packages/laravel/framework"><img src="https://img.shields.io/packagist/v/laravel/framework" alt="Latest Stable Version"></a>
<a href="https://packagist.org/packages/laravel/framework"><img src="https://img.shields.io/packagist/l/laravel/framework" alt="License"></a>
</p>

# About Package

This is a laravel package to be used with each microservice to setup main packages and configurations.

# Packages that will be installed

- [itspire/monolog-loki ^2.1](https://github.com/itspire/monolog-loki).
- [monolog/monolog ^3.5](https://github.com/Seldaek/monolog).
- [open-telemetry/opentelemetry-logger-monolog ^1.0](https://github.com/opentelemetry-php/contrib-logger-monolog).
- [predis/predis ^2.2](https://github.com/predis/predis).
- [vladimir-yuldashev/laravel-queue-rabbitmq ^13.3](https://github.com/vyuldashev/laravel-queue-rabbitmq) - [notion-documentation](https://malleable-corn-f1b.notion.site/RabbitMQ-Installation-f74ae9ffdded481281e42d6e674fa516).
- [knuckleswtf/scribe ^4.29](https://scribe.knuckles.wtf/laravel/).
- [maatwebsite/excel ^3.1](https://docs.laravel-excel.com/3.1/getting-started/).
- [barryvdh/laravel-snappy ^1.0](https://github.com/barryvdh/laravel-snappy).
- [h4cc/wkhtmltopdf-amd64 ^0.12.x](https://github.com/h4cc/wkhtmltopdf-amd64).
- [pestphp/pest ^2.33](https://pestphp.com/docs/installation).
- [phpunit/phpunit ^10.5](https://github.com/sebastianbergmann/phpunit).

# Installation

You can install the package via composer:

```bash
composer require andro-adel/microservice-package -W
```

# Vendor Publish

## Publish all the files

```bash
php artisan vendor:publish --provider="DD\MicroserviceCore\MicroserviceCoreServiceProvider"
```

## Publish the config files individually

```bash
php artisan vendor:publish --tag=dd-config
```

## Publish the lang files individually

```bash
php artisan vendor:publish --tag=dd-lang
```

## Publish the tests files individually

```bash
php artisan vendor:publish --tag=dd-tests
```

# Configuration

This package will automatically publish the configuration files in the config folder upon installation, extending the project configuration from ddconfig.
and this files are:

- ddconfig.php - This file will be used to configure the logging.channels and database.redis that will be used in the microservice.
- excel.php - This file will be used to configure the exporting and importing of excel files.
- scribe.php - This file will be used to configure the API documentation.
- services-communication.php - This file will be used to configure the services communication.
- snappy.php - This file will be used to configure the downloading and streaming of PDF files.

# Language

This package will automatically publish the language folder in the directory folder containing translations into Arabic and English.

# Testing

This package will automatically publish the tests folder in the directory folder containing the tests for the Pest package. and configure the phpunit.xml file to use the Pest package.

# Usage

## ApiResponses

This functions will be used by the microservice to return the response in a standard way.

```php
use DD\MicroserviceCore\Classes\ApiResponses;
```

### Success Response

This function will be used to return a success response with the data, reason, message, additionData, status.

```php
ApiResponses::successResponse(array $data, string $reason, string|null $message = null, array $additionData = [], $status = 200)
```

example:

```php
return ApiResponses::successResponse(data: ["user" : $user], reason: "User retrieved successfully", additionData: ["extra" : "extra value"]);
```

```json
{
  "status": 200,
  "success": true,
  "type": "success",
  "data": {
    "user": {
      "id": 1,
      "name": "John Doe",
      "email": "John@gmail.com"
    }
  },
  "reason": "User retrieved successfully",
  "message": "Done successfully",
  "extra": "extra value"
}
```

### Success No Content Response

This function will be used to return a success response with no content.

```php
ApiResponses::successNoContentResponse()
```

example:

```php
return ApiResponses::successNoContentResponse();
```

### Not Modified Response

This function will be used to return a not modified response.

```php
ApiResponses::notModifiedResponse(string|null $resourceName = null,string|null $message = null,array $additionData = [])
```

example:

```php
return ApiResponses::notModifiedResponse(resource: "User", message: "User not modified", additionData: ["extra" : "extra value"]);
```

```json
{
  "status": 304,
  "success": false,
  "type": "error",
  "reason": "Failure",
  "message": "User not modified",
  "extra": "extra value"
}
```

### Bad Request Response

This function will be used to return a bad request response.

```php
ApiResponses::badRequestResponse(string|null $message = null, array $additionData = [], $status = 400)
```

example:

```php
return ApiResponses::badRequestResponse(message: "Invalid data", additionData: ["extra" : "extra value"]);
```

```json
{
  "status": 400,
  "success": false,
  "type": "error",
  "reason": "Bad Request",
  "message": "Invalid data",
  "extra": "extra value"
}
```

### Unauthorized Response

This function will be used to return an unauthorized response.

```php
ApiResponses::unauthorizedResponse(string|null $message = null, array $additionData = [])
```

example:

```php
return ApiResponses::unauthorizedResponse(message: "Unauthorized User", additionData: ["extra" : "extra value"]);
```

```json
{
  "status": 403,
  "success": false,
  "type": "error",
  "reason": "Unauthorized",
  "message": "Unauthorized User",
  "extra": "extra value"
}
```

### Unauthenticated Response

This function will be used to return an unauthenticated response.

```php
ApiResponses::unauthenticatedResponse(string|null $message = null, array $additionData = [])
```

example:

```php
return ApiResponses::unauthenticatedResponse(message: "Unauthenticated User", additionData: ["extra" : "extra value"]);
```

```json
{
  "status": 401,
  "success": false,
  "type": "error",
  "reason": "Unauthenticated",
  "message": "Unauthenticated User",
  "extra": "extra value"
}
```

### Not Found Response

This function will be used to return a not found response.

```php
ApiResponses::notFoundResponse(string|null $resourceName = null, string|null $message = null, array $additionData = [])
```

example:

```php
return ApiResponses::notFoundResponse(resource: "User", message: "User not found", additionData: ["extra" : "extra value"]);
```

```json
{
  "status": 404,
  "success": false,
  "type": "error",
  "reason": "Not Found",
  "message": "User not found",
  "extra": "extra value"
}
```

### Conflict Response

This function will be used to return a conflict response.

```php
ApiResponses::conflictResponse(string $type,array $data,string|null $resourceName = null, string|null $message = null, array $additionData = [])
```

example:

```php
return ApiResponses::conflictResponse(type:"User",data: ["user" : $user], resourceName: "User", message: "User already exists", additionData: ["extra" : "extra value"]);
```

```json
{
  "status": 409,
  "success": false,
  "type": "User",
  "data": {
    "user": {
      "id": 1,
      "name": "John Doe",
      "email": "John@gmail.com"
    }
  },
  "reason": "Failure",
  "message": "User already exists",
  "extra": "extra value"
}
```

### Not Valid Response

This function will be used to return a not valid response.

```php
ApiResponses::notValidResponse(array $errors, array $data, string|null $message = null, array $additionData = [])
```

example:

```php
return ApiResponses::notValidResponse(errors: ["name" : "Name is required"], data: ["user" : $user], message: "Invalid data", additionData: ["extra" : "extra value"]);
```

```json
{
  "status": 422,
  "success": false,
  "type": "error",
  "reason": "Validation",
  "message": "Invalid data",
  "errors": {
    "name": "Name is required"
  },
  "data": {
    "user": {
      "id": 1,
      "email": "john.doe@gmail.com"
    }
  },
  "extra": "extra value"
}
```

### Server Error Response

This function will be used to return a server error response.

```php
ApiResponses::serverErrorResponse(string|int  $errorCode,string|null $message = null, array $additionData = [])
```

example:

```php
return ApiResponses::serverErrorResponse(errorCode: 500, message: "Server error", additionData: ["extra" : "extra value"]);
```

```json
{
  "status": 500,
  "success": false,
  "type": "error",
  "reason": "Exceptions",
  "message": "Server error",
  "errorCode": 500,
  "extra": "extra value"
}
```

### Success Pagination Response

This function will be used to return a success pagination response.

```php
ApiResponses::successPaginationResponse(LengthAwarePaginator $data, string $reason = 'Show', string|null $message = null, array $additionData = [])
```

example:

```php
return ApiResponses::successPaginationResponse(data: $users, reason: "Users retrieved successfully", additionData: ["extra" : "extra value"]);
```

```json
{
  "status": 200,
  "success": true,
  "type": "success",
  "data": {
    "current_page": 1,
    "data": [
      {
        "id": 1,
        "name": "John Doe",
        "email": "john.doe@gmail.com"
      },
      {
        "id": 2,
        "name": "Jane Doe",
        "email": "jane.doe@gmail.com"
      },
      {
        "id": 3,
        "name": "Ahmed",
        "email": "ahmed@gmail.com"
      }
    ],
    "first_page_url": "http://localhost:8000/api/users?page=1",
    "from": 1,
    "last_page": 1
  },
  "reason": "Users retrieved successfully",
  "message": "Done successfully",
  "extra": "extra value"
}
```

### Success Show Pagination Response

This function will be used to return a success show pagination response.

```php
ApiResponses::successShowPaginationResponse($data, $meta, string $reason = 'Show')
```

example:

```php
return ApiResponses::successShowPaginationResponse(data: $users, meta: $meta, reason: "Users retrieved successfully");
```

```json
{
  "status": 200,
  "success": true,
  "type": "success",
  "data": {
    "current_page": 1,
    "data": [
      {
        "id": 1,
        "name": "John Doe",
        "email": "john.doe@gmail.com",
        "created_at": "2022-01-01T00:00:00.000000Z",
        "updated_at": "2022-01-01T00:00:00.000000Z"
      },
      {
        "id": 2,
        "name": "ahmed Doe",
        "email": "ahmed.doe@gmail.com",
        "created_at": "2022-01-01T00:00:00.000000Z",
        "updated_at": "2022-01-01T00:00:00.000000Z"
      }
    ],
    "first_page_url": "http://localhost:8000/api/users?page=1",
    "from": 1,
    "last_page": 1
  },
  "reason": "Users retrieved successfully",
  "meta": {
    "current_page": 1,
    "from": 1,
    "last_page": 1,
    "path": "http://localhost:8000/api/users",
    "per_page": 15,
    "to": 2,
    "total": 2
  }
}
```

### Success Show Paginated Data Response

This function will be used to return a success show paginated data response.

```php
ApiResponses::successShowPaginatedDataResponse(JsonResource $data, string $reason = 'Show')
```

example:

```php
return ApiResponses::successShowPaginatedDataResponse(data: $users, reason: "Users retrieved successfully");
```

```json
{
  "status": 200,
  "success": true,
  "type": "success",
  "data": {
    "id": 1,
    "name": "John Doe",
    "email": "john.doe@gmail.com",
    "created_at": "2022-01-01T00:00:00.000000Z",
    "updated_at": "2022-01-01T00:00:00.000000Z"
  },
  "reason": "Users retrieved successfully",
  "count": 1
}
```

### Created Successfully Response

This function will be used to return a created successfully response.

```php
ApiResponses::createdSuccessfullyResponse($data = null, string|null $resourceName = null,?string $message = null)
```

example:

```php
return ApiResponses::createdSuccessfullyResponse(data: ["user" : $user], resourceName: "User", message: "User created successfully");
```

```json
{
  "status": 201,
  "success": true,
  "type": "success",
  "data": {
    "user": {
      "id": 1,
      "name": "John Doe",
      "email": "john.doe@gmail.com",
      "created_at": "2022-01-01T00:00:00.000000Z",
      "updated_at": "2022-01-01T00:00:00.000000Z"
    }
  },
  "reason": "Created",
  "message": "User created successfully"
}
```

## Caching

This functions will be used by the microservice to handle caching data.

```php
use DD\MicroserviceCore\Classes\Caching;
```

### Creating Object From Caching class

- **Creating Object From Caching class**

```php
$caching = new Caching();
```

and you can change the default connection on object creation by passing the connection name to the constructor.

```php
$caching = new Caching('connection_name');
```

or you can change the default connection after object creation by using the setConnection function.

```php
$caching->setConnection('connection_name');
```

- **Injecting Caching class**

```php
public function __construct(protected readonly Caching $caching) {}
```

and you can change the default connection after object creation by using the setConnection function.

```php
$caching->setConnection('connection_name');
```

### Caching Functions

- **Set Cache**

```php
$caching->set(string $key, mixed $value);
```

- **Set Cache With Options**

```php
use DD\MicroserviceCore\Classes\SetOptions;
$options = new SetOptions();
$options->setExpiration(int $ttl);
$options->setExpirationTimestamp(string $timestamp);
$options->setExpirationInMilliseconds(int $ttl);
$options->setExpirationTimestampInMilliseconds(string $timestamp);
$options->setExpirationSameAsOld();
$options->returnOldValue();
$options->setIfNew();
$options->setIfExist();
$caching->set(string $key, mixed $value, SetOptions $options);
```

- **Set Multiple Cache**

```php
$values = [
   'key1' => 'value1',
   'key2' => 'value2',
   'key3' => 'value3',
];
$caching->setMany(array $values);
```

- **Get Cache**

```php
$caching->get(string|array $key);
```

- **Rename Key**

```php
$caching->rename(string $oldKey, string $newKey);
```

- **Delete Cache**

```php
$caching->delete(string|array $key);
```

- **Get Key Type**

```php
$caching->getType(string $key);
```

- **Set Expire**

```php
$caching->setExpire(string $key, int $ttl);
```

- **Set Expire With Options**

```php
use DD\MicroserviceCore\Classes\ExpireOptions;
$options = new ExpireOptions();
$options->setIfNew();
$options->setIfExist();
$options->setIfGreaterThanCurrent();
$options->setIfLessThanCurrent();
$caching->set(string $key, int $ttl, ExpireOptions $options);
```

- **Check If Cache Exists**

```php
$caching->isKeyExist(string|array $key);
```

- **Key Searching**

```php
$caching->keySearching(string $pattern);
```

- **Get All Keys**

```php
$caching->getAllKeys();
```

- **Run Set of commands together**

```php
$caching->transaction(Closure $callback);
```

- **Run Command**

```php
$caching->command(string $command, array $values);
```

## Filters

This functions will be used by the microservice to handle filtering data.

```php
use DD\MicroserviceCore\Classes\FilterManager;
```

### Creating Object From FilterManager class

- **Creating Object From FilterManager class**

```php
$filterManager = new FilterManager();
```

filters data is the data that will be used to apply filters.

the default filters data will be set to the request data with key `filter`, and you can set filters data on object creation by passing the filters data to the constructor.

```php
$filterManager = new FilterManager(array $filtersData);
```

or you can set the filters data after object creation by using the setFiltersData function.

```php
$filterManager->setFiltersData(array $filtersData);
```

- **Injecting FilterManager class**

```php
public function __construct(protected readonly FilterManager $filterManager) {}
```

and you can set the filters data after object creation by using the setFiltersData function.

```php
$caching->setFiltersData(array $filtersData);
```

### Build Filters

- **Add Where Filter**

```php
$filterManager->addWhereFilter(string $column);
```

by default the operator will be set to `=`, you can pass the operator to the function to apply the operator to the filter.

```php
$filterManager->addWhereFilter(string $column, string $operator);
```

by default, when applying the filters the value for this where filter will be taken from the filters data with the same key as the column name, you can pass difference key to the function to apply the value to the filter.

```php
$filterManager->addWhereFilter(string $column, string $operator, string $valueKey);
```

- **Add Where In Filter**

```php
$filterManager->addWhereInFilter(string $column);
```

by default, when applying the filters the value for this where filter will be taken from the filters data with the same key as the column name, you can pass difference key to the function to apply the value to the filter.

```php
$filterManager->addWhereInFilter(string $column, string $valueKey);
```

- **Add Where Not In Filter**

```php
$filterManager->addWhereNotInFilter(string $column);
```

by default, when applying the filters the value for this where filter will be taken from the filters data with the same key as the column name, you can pass difference key to the function to apply the value to the filter.

```php
$filterManager->addWhereNotInFilter(string $column, string $valueKey);
```

- **Add Where Has Filter**
  **_[NOTE: you can't use this function with collection or array data.]_**

```php
$filterManager->addWhereHasFilter(string $relationName, Closure $callback);
```

by default, when applying the filters the value for this where filter will be taken from the filters data with the same key as the relation name, you can pass difference key to the function to apply the value to the filter.

```php
$filterManager->addWhereHasFilter(string $relationName, Closure $callback, string $valueKey);
```

- **Add Where Has Morph Filter**
  **_[NOTE: you can't use this function with collection or array data.]_**

```php
$filterManager->addWhereHasMorphFilter(string $relationName, string|array $types, Closure $callback);
```

by default, when applying the filters the value for this where filter will be taken from the filters data with the same key as the relation name, you can pass difference key to the function to apply the value to the filter.

```php
$filterManager->addWhereHasMorphFilter(string $relationName, string|array $types, Closure $callback, string $valueKey);
```

- **Add Has Filter**
  **_[NOTE: you can't use this function with collection or array data.]_**

```php
$filterManager->addHasFilter(string $relationName);
```

by default the operator will be set to `>=`, you can pass the operator to the function to apply the operator to the filter.

```php
$filterManager->addHasFilter(string $relationName, string $operator);
```

by default, when applying the filters the value for this where filter will be taken from the filters data with the same key as the column name, you can pass difference key to the function to apply the value to the filter.

```php
$filterManager->addHasFilter(string $relationName, string $operator, string $valueKey);
```

- **Add Where Between Filter**
  there are four ways to use this function.

  - **First way**

  ```php
  $filtersData = [
       $column => ['value1','value2'],
  ];
  $filterManager->addWhereBetweenFilter(string $column);
  ```

  - **Second way**

  ```php
  $filtersData = [
       $valueKey => ['value1','value2'],
  ];
  $filterManager->addWhereBetweenFilter(string $column, string $valueKey);
  ```

  - **Third way**

  ```php
  $filtersData = [
     'valueKey1' => 'value1',
     'valueKey2' => 'value2',
  ];
  $filterManager->addWhereBetweenFilter(string $column, ['valueKey1','valueKey2']);
  ```

  - **Forth way**
    if you have a different logic to apply the where between filter you can pass a callback to the function to apply the logic to the filter.

  ```php
  $callback = function(): array {};
  $filterManager->addWhereBetweenFilter(string $column, Closure $callback);
  ```

  - **Add Where Not Between Filter**
    there are four ways to use this function.

    - **First way**

    ```php
    $filtersData = [
       $column => ['value1','value2'],
    ];
    $filterManager->addWhereBetweenFilter(string $column);
    ```

    - **Second way**

    ```php
    $filtersData = [
       $valueKey => ['value1','value2'],
    ];
    $filterManager->addWhereBetweenFilter(string $column, string $valueKey);
    ```

    - **Third way**

    ```php
    $filtersData = [
       'valueKey1' => 'value1',
       'valueKey2' => 'value2',
    ];
    $filterManager->addWhereBetweenFilter(string $column, ['valueKey1','valueKey2']);
    ```

    - **Forth way**

    if you have a different logic to apply the where between filter you can pass a callback to the function to apply the logic to the filter.

    ```php
    $callback = function(): array {};
    $filterManager->addWhereBetweenFilter(string $column, Closure $callback);
    ```

- **Add Where Function Filter**

```php
$filterManager->addWhereFunctionFilter(Closure $callback, string $filterKey);
```

`$filterKey` is the key that will be used to check if this filter will be applied or not.

- **Add Multiple Where Filter**

```php
$columns = [
   'column1',
   'column2' => 'valueKey',
   'column3'
];
$filterManager->addMultipleWhereFilter(array $columns);
```

by default the operator will be set to `=`, you can pass the operator to the function to apply the operator to the filter.

```php
$filterManager->addMultipleWhereFilter(array $columns, string $operator);
```

- **Add Multiple Where In Filter**

```php
$columns = [
   'column1',
   'column2' => 'valueKey',
   'column3'
];
$filterManager->addMultipleWhereInFilter(array $columns);
```

- **Add Multiple Where Not In Filter**

```php
$columns = [
   'column1',
   'column2' => 'valueKey',
   'column3'
];
$filterManager->addMultipleWhereNotInFilter(array $columns);
```

- **Add Multiple Where Has Filter**
  **_[NOTE: you can't use this function with collection or array data.]_**

```php
$relations = [
   'relation1' => function($query){},
   'relation2' => function($query){},
   'relation3' => function($query){}
];
$filterManager->addMultipleWhereHasFilter(array $relations);
```

- **Add Multiple Has Filter**

```php
$relations = [
   'relation1',
   'relation2' => 'valueKey',
   'relation3'
];
$filterManager->addMultipleHasFilter(array $relations);
```

by default the operator will be set to `>=`, you can pass the operator to the function to apply the operator to the filter.

```php
$filterManager->addMultipleHasFilter(array $relations, string $operator);
```

- **Add Multiple Where Between Filter**

```php
$data = [
   'column1',
   'column2' => 'valueKey',
   'column3' => ['valueKey1', 'valueKey2'],
   'column4' => functioin(): array {}
];
$filterManager->addMultipleWhereBetweenFilter(array $data);
```

- **Add Multiple Where Not Between Filter**

```php
$data = [
   'column1',
   'column2' => 'valueKey',
   'column3' => ['valueKey1', 'valueKey2'],
   'column4' => functioin(): array {}
];
$filterManager->addMultipleWhereNotBetweenFilter(array $data);
```

### Applying Filters

Now you can simply call function `applyFilters` from `$filterManager` object.

```php
$filterManager->applyFilters(Relation|Builder|Collection|array &$data)
```

And your data will be filtered.

#### Example

```php
use DD\MicroserviceCore\Classes\FilterManager;
use DD\MicroserviceCore\Interfaces\ServiceInterface;
use Illuminate\Database\Eloquent\Builder;
use Illuminate\Database\Eloquent\Relations\Relation;
use Illuminate\Support\Collection;

class ModelService implements ServiceInterface
{

   /**
   * @inheritDoc
   */
   public function applyFilters(Relation|Builder|array|Collection &$data, ?array $filtersData = null): void
   {
      $filterManager = new FilterManager($filtersData);

      $filterManager->addMultipleWhereFilter(['name', 'email' => 'mail'], 'LIKE');
      $filterManager->addWhereInFilter('id');

      $filterManager->applyFilters($data);
   }
}
```

## Logging

```php
use DD\MicroserviceCore\Classes\Logging
```

### Logging Types

- emergency
- alert
- critical
- error
- warning
- notice
- info
- debug

### Functions

For each type there are an static function to handle it, all function have two parameters `string $message` and `array $context = []`.

```php
Logging::emergency(string $message, array $context);
Logging::alert(string $message, array $context);
Logging::critical(string $message, array $context);
Logging::error(string $message, array $context);
Logging::warning(string $message, array $context);
Logging::notice(string $message, array $context);
Logging::info(string $message, array $context);
Logging::debug(string $message, array $context);
```
